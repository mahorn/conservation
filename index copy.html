<!DOCTYPE html>
<html>

<head>
    <meta charset=utf-8 />
    <title>Conservation Areas in South America</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- <script src='https://api.mapbox.com/mapbox.js/v3.2.0/mapbox.js'></script> -->
    <!-- added mapbox-gl-js to see if ocean loads -->
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.css' rel='stylesheet' />
    <!-- end of mapbox-gl-js to see if ocean loads -->
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link href="https://api.mapbox.com/mapbox-assembly/v0.21.2/assembly.min.css" rel="stylesheet">
    <link href='https://api.mapbox.com/mapbox.js/v3.2.0/mapbox.css' rel='stylesheet' />

    <style>
        body {
            padding-top: 0;
        }

        #map {
            padding: 0;
            position: fixed;
            width: 100%;
            height: 100%;
        }

        /* .marker {
            background-image: url('pics/wildlife_icon.png');
            background-size: cover;
            width: 20px;
            height: 20px;
            border-radius: 5%;
            cursor: pointer;
        } */

        .popup {
            text-align: center;
        }

        .popup .slideshow .image {
            display: none;
        }

        .popup .slideshow .image.active {
            display: block;
        }

        .popup .slideshow img {
            width: 100%;
        }

        .popup .slideshow .caption {
            background: #eee;
            padding: 10px;
        }

        .popup .cycle {
            padding: 10px 0 20px;
        }

        .popup .cycle a.prev {
            float: left;
        }

        .popup .cycle a.next {
            float: right;
        }
    </style>
</head>

<body>
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
        integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <!--adding libraries to see if ocean loads-->
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.53.1/mapbox-gl.js'></script>
    <script src="https://d3js.org/d3.v5.min.js"></script>
    <script src="https://unpkg.com/topojson@3"></script>

    <!--scrolling libraries-->
    <!-- <script src="lib/d3.js"></script>
    <script src="js/scroller.js"></script>
    <script src="js/sections.js"></script> -->

    <div id='map'>

        <script>
            mapboxgl.accessToken = 'pk.eyJ1IjoibWFob3JuIiwiYSI6ImNpbnV0enJ4ZTEyNG91YW0zNGF6bTlva2wifQ.7jRtxQoaV2PHlRD7fu6U-g';

            var map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mahorn/cjvhdsr2b0ga81cmke0w0ef0p',
                center: [-65, -15],
                zoom: 2.6,
            });



            map.on('load', function () {

                d3.json('data/unesco.json')
                    .then(function (data) {
                        galleryMap(data);
                    });


                function galleryMap(data) {
                    data.features.forEach(function (feature) {

                        //   var coordinates = feature.geometry.coordinates;
                        //   console.log(coordinates);
                    });
                    map.addLayer({
                        'id': 'centroids',
                        'type': 'circle',
                        'source': {
                            'type': 'geojson',
                            'data': {
                                'type': 'FeatureCollection',
                                'features': [{
                                    'type': 'Feature',
                                    'geometry': {
                                        'type': 'Point',
                                        'coordinates': [-69.26649821726008, -29.23805445056377]
                                    },

                                    'properties': {

                                        'title': 'Washington, D.C.',
                                        'marker-color': '#3c4e5a',
                                        'marker-symbol': 'monument',
                                        'marker-size': 'large',

                                        'images': 
                                        "<a href='"+"' target=\"_blank\">"+"<img src='pics/point.png'+'&previewImage=true'</img></a>",
                                           
                                    }
                                    
                                }]
                            }
                        }
                        //  'layout': none,
                    });

                    var popup = new mapboxgl.Popup({
                        closeButton: false,
                        closeOnClick: false,
                    });

                    map.on('click', 'centroids', function (e) {
                        var coordinates = e.features[0].geometry.coordinates.slice();
                        console.log(coordinates);
                        
                     
                        
                        var images = e.features[0].properties.images;
           

                     
                        new mapboxgl.Popup()
                            .setLngLat(coordinates)
                            .setHTML(images)

                            .addTo(map);

                    });



                    // data.features.forEach(function(marker) {
                    //     //     // create a HTML element for each feature
                    //     var el = document.createElement('div');
                    //     el.className = 'marker';
                    //     //     // make a marker for each feature and add to the map
                    //     new mapboxgl.Marker(el)
                    //         .setLngLat(marker.geometry.coordinates)
                    //         .setPopup(new mapboxgl.Popup({
                    //                 offset: 25
                    //             }) // add popups
                    //             .setHTML('<h3>' + marker.properties.NAME + '</h3><p>' + marker.properties.DESIG_ENG + '</p><p>' + marker.properties.IUCN_CAT + '</p>'))
                    //         .addTo(map);
                    // });

                } //end of function pointsMap

            }); //end of map.on('load')
        </script>

</body>

</html>